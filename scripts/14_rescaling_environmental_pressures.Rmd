---
title: "Rescaling environmental pressures"
author: "Rich Cottrell"
date: "30/06/2022"
output: html_document
---

This file is used to rescale all rasters' values for each pressure so that values among feeds may be compared.

```{r}

library(tidyverse)
library(terra)
library(here)


select <- dplyr::select
values <- terra::values
```


## Disturbance

Bring in  forage fish and crop layers for disturbance for both diets. Look at the values to establish a percentile to use for rescaling.

```{r}

marine_diet_disturbance <- list.files(here("data/spatial/marine_diet/int"), pattern = "disturbance_km2", full.names = TRUE)

plant_diet_disturbance <- list.files(here("data/spatial/plant_diet/int"), pattern = "disturbance_km2", full.names = TRUE)

all_disturbance <- c(marine_diet_disturbance, plant_diet_disturbance)

this_file <- all_disturbance[[1]]

all_disturbance_vals <- unlist(map(.x = all_disturbance, .f = \(this_file){
  
  this_rast <- rast(this_file)
  
  these_rast_values <- as.vector(values(this_rast, na.rm=TRUE))
  
  return(these_rast_values)
  
  
}))


quantile(all_disturbance_vals, 0.9)

hist(unlist(all_distrubance_list))





```
# Greenhouse gas pressures

```{r}

marine_diet_ghg <- list.files(here("data/spatial/marine_diet/int"), pattern = "ghg", full.names = TRUE)

plant_diet_ghg <- list.files(here("data/spatial/plant_diet/int"), pattern = "ghg", full.names = TRUE)

all_ghg <- c(marine_diet_ghg, plant_diet_ghg)

this_file <- all_ghg[[1]]

all_ghg_vals <- unlist(map(.x = all_ghg, .f = \(this_file){
  
  this_rast <- rast(this_file)
  
  these_rast_values <- as.vector(values(this_rast, na.rm=TRUE))
  
  return(these_rast_values)
}))


quantile(all_ghg_vals, 0.9)

hist(all_ghg_vals)




```









